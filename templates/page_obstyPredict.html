{% extends "base.html" %}

{% block title %}Tes Obesitas - LoYS{% endblock %}

{% block content %}
<div class="row mt-4">
  <div class="col-12">
    <div class="card shadow-lg border-0">
      <div class="card-header bg-success text-white">
        <h3 class="mb-0">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-clipboard2-pulse me-2" viewBox="0 0 16 16">
            <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
            <path d="M3 2.5a.5.5 0 0 1 .5-.5H4a.5.5 0 0 0 0-1h-.5A1.5 1.5 0 0 0 2 2.5v12A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-12A1.5 1.5 0 0 0 12.5 1H12a.5.5 0 0 0 0 1h.5a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5z"/>
            <path d="M9.979 5.356a.5.5 0 0 0-.968.04L7.92 10.49l-.94-3.135a.5.5 0 0 0-.926-.08L4.69 10H4.5a.5.5 0 0 0 0 1H5a.5.5 0 0 0 .447-.276l.936-1.873 1.138 3.793a.5.5 0 0 0 .968-.04L9.58 7.51l.94 3.135A.5.5 0 0 0 11 11h.5a.5.5 0 0 0 0-1h-.128z"/>
          </svg>
          Tes Prediksi Obesitas
        </h3>
        <p class="mb-0 mt-2 small">Isi formulir di bawah untuk mengetahui prediksi tingkat obesitas Anda</p>
      </div>
      <div class="card-body p-4">
        <form id="obesityForm" action="{{ url_for('obsityPredict') }}" method="POST">
          <!-- Section 1: Data Pribadi -->
          <div class="mb-4  mt-3">
            <h5 class="text-success border-bottom pb-2 mb-3">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-fill me-2" viewBox="0 0 16 16">
                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
              </svg>
              Data Pribadi
            </h5>
            
            <div class="row g-3">
              <!-- Gender -->
              <div class="col-md-6">
                <label for="gender" class="form-label fw-bold">Jenis Kelamin </label>
                <select class="form-select" id="gender" name="gender" required>
                  <option value="">Pilih jenis kelamin</option>
                  <option value="Male">Laki-laki</option>
                  <option value="Female">Perempuan</option>
                </select>
              </div>

              <!-- Age -->
              <div class="col-md-6">
                <label for="age" class="form-label fw-bold">Usia (tahun) </label>
                <input type="number" class="form-control" id="age" name="age" min="1" max="120" placeholder="Contoh: 25" required>
              </div>

              <!-- Height -->
              <div class="col-md-6">
                <label for="height" class="form-label fw-bold">Tinggi Badan (meter)</label>
                <input type="number" class="form-control" id="height" name="height" min="0.5" max="3" step="0.01" placeholder="Contoh: 1.70" required>
              </div>

              <!-- Weight -->
              <div class="col-md-6">
                <label for="weight" class="form-label fw-bold">Berat Badan (kg) </label>
                <input type="number" class="form-control" id="weight" name="weight" min="20" max="300" step="0.1" placeholder="Contoh: 70" required>
              </div>

              <!-- Family History -->
              <div class="col-12">
                <label for="family_history" class="form-label fw-bold">Riwayat Keluarga dengan Berat Badan Berlebih </label>
                <select class="form-select" id="family_history" name="family_history" required>
                  <option value="">Pilih jawaban</option>
                  <option value="yes">Ya</option>
                  <option value="no">Tidak</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Section 2: Kebiasaan Makan -->
          <div class="mb-4  mt-3">
            <h5 class="text-success border-bottom pb-2 mb-3">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-egg-fried me-2" viewBox="0 0 16 16">
                <path d="M8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                <path d="M13.997 5.17a5 5 0 0 0-8.101-4.09A5 5 0 0 0 1.28 9.342a5 5 0 0 0 8.336 5.109 3.5 3.5 0 0 0 5.201-4.065 3.001 3.001 0 0 0-.822-5.216zm-1-.034a1 1 0 0 0 .668.977 2.001 2.001 0 0 1 .547 3.478 1 1 0 0 0-.341 1.113 2.5 2.5 0 0 1-3.715 2.905 1 1 0 0 0-1.262.152 4 4 0 0 1-6.67-4.087 1 1 0 0 0-.2-1 4 4 0 0 1 3.693-6.61 1 1 0 0 0 .8-.2 4 4 0 0 1 6.48 3.273z"/>
              </svg>
              Kebiasaan Makan
            </h5>

            <div class="row g-3">
              <!-- FAVC -->
              <div class="col-md-6">
                <label for="favc" class="form-label fw-bold">Sering Konsumsi Makanan Berkalori Tinggi </label>
                <select class="form-select" id="favc" name="favc" required>
                  <option value="">Pilih jawaban</option>
                  <option value="yes">Ya</option>
                  <option value="no">Tidak</option>
                </select>
              </div>

              <!-- FCVC -->
              <div class="col-md-6">
                <label for="fcvc" class="form-label fw-bold">Frekuensi Konsumsi Sayuran </label>
                <select class="form-select" id="fcvc" name="fcvc" required>
                  <option value="">Pilih frekuensi</option>
                  <option value="1">Jarang</option>
                  <option value="2">Sedang</option>
                  <option value="3">Sering</option>
                </select>
              </div>

              <!-- NCP -->
              <div class="col-md-6">
                <label for="ncp" class="form-label fw-bold">Jumlah Makan Utama per Hari </label>
                <input type="number" class="form-control" id="ncp" name="ncp" min="1" max="10" step="0.1" placeholder="Contoh: 3" required>
              </div>

              <!-- CAEC -->
              <div class="col-md-6">
                <label for="caec" class="form-label fw-bold">Frekuensi Ngemil di Antara Waktu Makan </label>
                <select class="form-select" id="caec" name="caec" required>
                  <option value="">Pilih frekuensi</option>
                  <option value="no">Tidak Pernah</option>
                  <option value="Sometimes">Kadang-kadang</option>
                  <option value="Frequently">Sering</option>
                  <option value="Always">Selalu</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Section 3: Gaya Hidup -->
          <div class="mb-4 mt-3">
            <h5 class="text-success border-bottom pb-2 mb-3">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-heart-pulse me-2" viewBox="0 0 16 16">
                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053.918 3.995.78 5.323 1.508 7H.43c-2.128-5.697 4.165-8.83 7.394-3.485q.09.083.176.171a3 3 0 0 1 .176-.17c3.23-5.346 9.522-2.213 7.394 3.485h-1.078c.728-1.677.59-3.005.108-3.947C13.486.878 10.4.28 8.717 2.01zM2.212 10h1.315C4.593 11.183 6.05 12.458 8 13.795c1.949-1.337 3.407-2.612 4.473-3.795h1.315c-1.265 1.566-3.14 3.25-5.788 5-2.648-1.75-4.523-3.434-5.788-5"/>
                <path d="M10.464 3.314a.5.5 0 0 0-.945.049L7.921 8.956 6.464 5.314a.5.5 0 0 0-.88-.091L3.732 8H.5a.5.5 0 0 0 0 1H4a.5.5 0 0 0 .416-.223l1.473-2.209 1.647 4.118a.5.5 0 0 0 .945-.049l1.598-5.593 1.457 3.642A.5.5 0 0 0 12 9h3.5a.5.5 0 0 0 0-1h-3.162z"/>
              </svg>
              Gaya Hidup & Aktivitas
            </h5>

            <div class="row g-3">
              <!-- SMOKE -->
              <div class="col-md-6">
                <label for="smoke" class="form-label fw-bold">Apakah Anda Merokok? </label>
                <select class="form-select" id="smoke" name="smoke" required>
                  <option value="">Pilih jawaban</option>
                  <option value="yes">Ya</option>
                  <option value="no">Tidak</option>
                </select>
              </div>

              <!-- CH2O -->
              <div class="col-md-6">
                <label for="ch2o" class="form-label fw-bold">Konsumsi Air per Hari </label>
                <select class="form-select" id="ch2o" name="ch2o" required>
                  <option value="">Pilih konsumsi air</option>
                  <option value="1">Sedikit (< 1 liter)</option>
                  <option value="2">Cukup (1-2 liter)</option>
                  <option value="3">Banyak (> 2 liter)</option>
                </select>
              </div>

              <!-- SCC -->
              <div class="col-md-6">
                <label for="scc" class="form-label fw-bold">Memantau Asupan Kalori </label>
                <select class="form-select" id="scc" name="scc" required>
                  <option value="">Pilih jawaban</option>
                  <option value="yes">Ya</option>
                  <option value="no">Tidak</option>
                </select>
              </div>

              <!-- FAF -->
              <div class="col-md-6">
                <label for="faf" class="form-label fw-bold">Frekuensi Aktivitas Fisik per Minggu </label>
                <select class="form-select" id="faf" name="faf" required>
                  <option value="">Pilih frekuensi</option>
                  <option value="0">Tidak Pernah (0)</option>
                  <option value="1">Jarang (1-2 hari)</option>
                  <option value="2">Sedang (3-4 hari)</option>
                  <option value="3">Sering (5-7 hari)</option>
                </select>
              </div>

              <!-- TUE -->
              <div class="col-md-6">
                <label for="tue" class="form-label fw-bold">Waktu Penggunaan Teknologi per Hari </label>
                <select class="form-select" id="tue" name="tue" required>
                  <option value="">Pilih durasi</option>
                  <option value="0">0-2 jam</option>
                  <option value="1">3-5 jam</option>
                  <option value="2">5-8 jam</option>
                  <option value="3">> 8 jam</option>
                </select>
              </div>

              <!-- CALC -->
              <div class="col-md-6">
                <label for="calc" class="form-label fw-bold">Frekuensi Konsumsi Alkohol </label>
                <select class="form-select" id="calc" name="calc" required>
                  <option value="">Pilih frekuensi</option>
                  <option value="no">Tidak Pernah</option>
                  <option value="Sometimes">Kadang-kadang</option>
                  <option value="Frequently">Sering</option>
                  <option value="Always">Selalu</option>
                </select>
              </div>

              <!-- MTRANS -->
              <div class="col-12">
                <label for="mtrans" class="form-label fw-bold">Moda Transportasi Utama </label>
                <select class="form-select" id="mtrans" name="mtrans" required>
                  <option value="">Pilih transportasi</option>
                  <option value="Automobile">Mobil</option>
                  <option value="Bike">Sepeda</option>
                  <option value="Motorbike">Motor</option>
                  <option value="Public_Transportation">Transportasi Umum</option>
                  <option value="Walking">Jalan Kaki</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Submit Button -->
          <div class="d-grid gap-2 mt-4">
            <button type="submit" class="btn btn-success btn-lg" id="submitBtn">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-clipboard-check me-2" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
              </svg>
              Prediksi Obesitas
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Result Modal -->
<div class="modal fade" id="resultModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-clipboard-data me-2" viewBox="0 0 16 16">
            <path d="M4 11a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0zm6-4a1 1 0 1 1 2 0v5a1 1 0 1 1-2 0zM7 9a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0z"/>
            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
          </svg>
          Hasil Prediksi Obesitas
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="resultContent">
        {{hasil}}
      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>

{% if hasil %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    var modal = new bootstrap.Modal(document.getElementById('resultModal'));
    modal.show();
  });
</script>
{% endif %}

{% endblock %}
